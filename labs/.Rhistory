q()
cov1 = matrix(data=c(1,0,1,0))
cov1
cov1 = matrix(data=c(1,0,1,0)nrow=2)
cov1 = matrix(data=c(1,0,1,0),nrow=2)
cov1
cov2 = matrix(data=c(1,0.5,0.5,1),nrow=2)
det(cov2)
det(cov1)
cov1
cov1 = matrix(data=c(1,0,0,1),nrow=2)
cov1
det(cov1)
X<-rnorm(N,mean,cov1)
N=500
mean1 = c(1,1)
mean2 = c(-1,-1)
cov1 = matrix(data=c(1,0,0,1),nrow=2)
cov2 = matrix(data=c(1,0.5,0.5,1),nrow=2)
X<-rnorm(N,mean,cov1)
X<-rnorm(N,mean1,cov1)
X
X<-rnorm(N,mean1)
N=500
mean1 = c(1,1)
mean2 = c(-1,-1)
X<-rnorm(N,mean1)
setwd('~/Documents/cours_3A/sdma/labs/tp1')
data = read.table("UsCrime.txt")
tab = read.table("UsCrime.txt")
setwd('~/Documents/cours_3A/sdma/labs/tp1')
tab = read.table("UsCrime.txt")
View(tab)
tab = read.table("UsCrime.txt", header=T)
View(tab)
plot(tab[,1], tab[,2])
plot(tab[,1], tab[,3])
plot(tab[,1], tab[,4])
plot(tab[,1], tab[,5])
plot(tab[,1], tab[,-1])
tab[,-1]
for(i in 2:14)
plot(tab[,1], tab[,i])
corr_matrix = cor(tab)
View(corr_matrix)
res = lm('R~.', data=tab)
print(res)
summary(res)
attributes(res)
names(res)
plot(res$residuals)
hist(res$residuals)
plot(tab)
res$coefficients
coeffs = res$coefficients
coeffs
attributes(res)
res$model
attributes(res)
res$rank
res
summary(res)
summary(res)$coefficients
confint(res)
confint(res, level=0.95)
confint(res, level=0.99)
attributes(res)
res$fitted.values
plot(tab$R,res$fitted.values)
abline(a=1,b=0)
plot(tab$R,res$fitted.values)
abline(a=1,b=0)
plot(tab$R,res$fitted.values)
abline(a=0,b=1)
plot(tab$R,res$fitted.values, col="blue")
abline(a=0,b=1)
summary(res)
mean(tab$R - res$fitted.values)
var(tab$R - res$fitted.values)
sd(tab$R - res$fitted.values)
sd(tab$R - res$fitted.values)^2
nrow(tab)
conf_prediction = matrix(data=0,ncol=3,nrow=nrow(tab))
conf_prediction = data.frame(matrix(data=0,ncol=3,nrow=nrow(tab)))
names(conf_prediction) = c("prediction", "pred_inf", "pred_sup")
conf_prediction$prediction = res$fitted.values
confint(res, level=0.95)
sd_epsilon = sd(tab$R - res$fitted.values)
conf_prediction$pred_inf = res$fitted.values - qnorm(0.0025, sd=sd_epsilon)
conf_prediction$pred_inf = res$fitted.values + qnorm(0.975, sd=sd_epsilon)
View(conf_prediction)
conf_prediction$pred_inf = res$fitted.values + qnorm(0.975, sd=sd_epsilon)
View(conf_prediction)
qnorm(0.975, sd=sd_epsilon)
qnorm(0.0025, sd=sd_epsilon)
conf_prediction$prediction = res$fitted.values
conf_prediction$pred_inf = res$fitted.values + qnorm(0.0025, sd=sd_epsilon)
conf_prediction$pred_sup= res$fitted.values + qnorm(0.975, sd=sd_epsilon)
View(conf_prediction)
plot(tab$R,res$fitted.values, col="blue")
abline(a=0,b=1)
lines(conf_prediction$pred_inf, col="red")
plot(tab$R,res$fitted.values, col="blue")
abline(a=0,b=1)
lines(tab$R,conf_prediction$pred_inf, col="red")
points(tab$R,conf_prediction$pred_inf, col="red")
plot(tab$R,res$fitted.values, col="blue")
abline(a=0,b=1)
points(tab$R,conf_prediction$pred_inf, col="red")
points(tab$R,conf_prediction$pred_sup, col="red")
boxplot(conf_prediction)
boxplot(t(conf_prediction))
boxplot(tab$R~t(conf_prediction))
boxplot(t(conf_prediction)~tab$R)
boxplot(t(conf_prediction))
attributes(res)
res$residuals
sd(res$residuals)
sd_epsilon = sd(res$residuals)
err_resid = mean(res$residuals^2)
n = nrow(tab)
p = ncol(tab) - 1
err_resid_nb = err_resid*(n/(n-p))
plot(res$residuals,tab$R)
res$fitted.values
plot(res$residuals,tab$R)
qqnorm(res$residuals)
abline(0,1, col="blue")
abline(a=0,b=1, col="blue")
qqnorm(res$residuals)
abline(a=0,b=1, col="blue")
qqnorm(res$residuals/err_resid_nb)
abline(a=0,b=1, col="blue")
qqnorm(res$residuals/sqrt(err_resid_nb))
abline(a=0,b=1, col="blue")
qqnorm(res$residuals/sqrt(err_resid_nb))
qqline(res$residuals/sqrt(err_resid_nb))
qqnorm(res$residuals)
qqline(res$residuals, col="blue")
shapiro.test(res$residuals)
qqnorm(res$residuals)
qqline(res$residuals, col="blue") #Le modÃ¨le parait etre normal
shapiro.test(res$residuals)
indTest = seq(1,n,3)
res
summary(res)
predicted = predict(res,interval="prediction",level=0.95)
predicted = predict(res,interval="prediction",level=0.95, type="terms")
predicted = predict(res)
predicted = predict(res, interval="confidence", level=0.95)
head(predicted)
predicted$upr-predicted$lwr
predicted[,3]-predicted[,2]
plot(tab$R, res$fitted.values)
lines(tab$R, predicted[,2], lty=5, col="orange")
lines(tab$R, predicted[,3], lty=5, col="orange")
plot(tab$R, res$fitted.values)
predicted
lines(tab$R, res$fitted.values+qnorm(0.025,sd=sd(res$residuals)), lty=5, col="orange")
plot(tab$R, res$fitted.values)
qnorm(0.025,sd=sd(res$residuals))
abline(a=qnorm(0.025,sd=sd(res$residuals)),b=1)
plot(tab$R, res$fitted.values)
abline(a=qnorm(0.025,sd=sd(res$residuals)),b=1, col="orange")
abline(a=qnorm(0.975,sd=sd(res$residuals)),b=1, col="orange")
abline(a=qnorm(0.975,sd=sd(res$residuals)),b=1, col="red")
plot(tab$R, res$fitted.values)
abline(a=qnorm(0.025,sd=sd(res$residuals)),b=1, col="orange")
abline(a=qnorm(0.975,sd=sd(res$residuals)),b=1, col="orange")
abline(a=0,b=1, col="red")
indTest = seq(1,n,3)
length(indTest)
tabTest = tab[indTest,]
tabTrain = tab[-indTest,]
res = lm('R~.', data=tabTrain)
predicted = predict(res, newdata=tabTest)
err = mean((predicted-tabTest$R)^2)
err
err_mean = mean((predicted-tabTest$R)^2)
err_sd = sd((predicted-tabTest$R)^2)
plot((predicted-tabTest$R)^2)
hist((predicted-tabTest$R)^2, fre=F)
err_resid
err_mean
err_sd
x11()
par(mfrow=c(2,2))
plot(res)
res = lm('R~.', data=tab)
regbackward = step(res, director="backward")
summary(regbackward)
plot(regbackward)
regforward = step(res, director="forward")
summary(regbackward)
summary(regforward)
regboth = step(res, director="both")
summary(regboth)
formula(regboth)
tab = read.table("SAHeart.txt")
tab = read.table("SAHeart.txt")
tab = read.table("SAheart.txt")
tab = read.table("SAheart.txt", header=T)
tab = read.table("SAheart.txt", header=F)
tab = read.table("SAheart.txt", header=F)
tab = read.table("SAheart.txt", header=T)
tab = read.table("SAheart.txt", header=F)
tab = read.csv("SAheart.txt", header=T)
View(tab)
View(tab)
data = tab[,c("ldl")]
data = tab[,c("sbp","tobacco","ldl","famhist","obesuty","alcohol","age","chd")]
data = tab[,c("sbp","tobacco","ldl","famhist","obesity","alcohol","age","chd")]
res = lm('R~.', data=tab)
plot(tab$R, res$fitted.values)
plot(tab$R, res$fitted.values)
tab = read.table("UsCrime.txt", header=T)
res = lm('R~.', data=tab)
plot(tab$R, res$fitted.values)
abline(a=qnorm(0.025,sd=sd(res$residuals)),b=1, col="orange")
abline(a=qnorm(0.975,sd=sd(res$residuals)),b=1, col="orange")
abline(a=0,b=1, col="red")
